<section class="section">
  <h1 class="has-text-centered title">Your Order</h1>
  <div class="container is-fluid has-text-centered">
    <p class="has-text-centered">Status: <%= @order.status.capitalize %></p>
    <p class="has-text-centered">Total Items in Cart: <%= total_quantity(@order) %></p>
    <p class="has-text-centered">Total: <%= number_to_currency @order.total %></p>
    <%= link_to "Empty Cart", @order, data: { confirm: 'Are you sure?' }, method: :delete %>
  </div>
  <br>
  <div class="container is-fluid shop-grid">
      <% @order.order_items.each do |item| %>
      <div class="shop-grid-item">        
        <%= image_tag item.product.image.url(:medium) %>
        <p><%= item.product.name %></p>
        <div class="quantity">
          <span id="to-grow">Quantity: <%= item.quantity %></span>
          <%= link_to "Add One", order_item_add_path(:id => item), method: :post, class: "button is-success is-small" %>
          <%= link_to "Remove One", order_item_reduce_path(:id => item), method: :post, class: "button is-danger is-small" %>
        </div>
        <% if item.product.stock < item.quantity %>
            <span class="is-uppercase has-text-danger has-text-weight-bold">Not Enough Stock To Fill Request!</span>
          <% end %>
        <p>(Subtotal: <%= number_to_currency item.subtotal %>)</p>
        <%= link_to 'Remove item from cart', item, method: :delete, data: { confirm: 'Are you sure?' } %>
      </div>
      <% end %>     
    </div>
    <div class="container is-fluid address has-text-centered">
      <br />
      <h2 class="subtitle">Shipping to:</h2>
      <% current_user.addresses.each do |a| %>
        <p class="has-text-weight-bold"><%= current_user.email %></p>
        <p><%= a.line1 %></p>
        <p><%= a.city %>, <%= a.state %> <%= a.zip %></p>
        <button class="button is-small">
          <%= link_to "Edit Address", edit_address_path(:id => current_user.addresses.ids ) %>
        </button>
      <% end %>
    </div>
  </div>
</section>